# MANUAL: Codexが参照する対応表（ソース → AUTOファイル）
version: 0.1
mappings:
  - id: openapi
    source: backend/app/openapi.yaml
    target: docs/specs/openapi.yaml   # ← DS-1でAUTO管理にした先
    mode: replace                     # 生成結果で置き換え（最小）
    allow_shrink: false               # 痩せ（縮小）を禁止
    min_paths: 3                      # paths が閾値未満ならスキップ

  # 将来、部分更新したいとき用の雛形（今は使わない）
  # - id: openapi-fragment
  #   source: backend/app/fragment.yaml
  #   target: docs/specs/openapi.yaml
  #   mode: overlay

docs_changed:
  targets:
    - path: docs/agile/plan.md
      sections: ['plan.meta']
    - path: docs/agile/workorder.md
      sections: ['workorder.meta']
    - path: docs/agile/review.md
      sections: ['review.meta']

plan_changed:
  targets:
    - path: docs/agile/plan.md
      sections: ['plan.meta', 'plan.inputs', 'plan.outputs', 'plan.tasks']

workorder_ready:
  sources:
    - path: docs/agile/plan.md
      sections: ['plan.meta', 'plan.tasks']
  targets:
    - path: docs/agile/workorder.md
      sections: ['workorder.meta']

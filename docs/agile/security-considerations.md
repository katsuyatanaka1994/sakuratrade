# セキュリティシート

- 作成者（Codex）:
- レビュアー（人間）:
- 最終更新日:
- 次回レビュー期限:
- バージョン:
- 適用範囲: (例: production, staging, internal APIs, mobile app)

## 1. 目的・スコープ
この文書は、[プロダクト名] におけるセキュリティ設計・運用要件を定義し、対象範囲と除外範囲を明確にする。

## 2. 用語定義
| 用語 | 説明 |
| --- | --- |
| PII | 個人識別情報 |
| RTO / RPO | （短い定義） |
|  |  |

## 3. 体制と責任
| 役割 | 担当 | 連絡先 | 補足 |
| --- | --- | --- | --- |
| セキュリティオーナー |  |  |  |
| インシデント対応責任者 |  |  |  |
| インシデント連絡経路 |  |  | 例: Slack #incident / Phone |
| レビュー頻度 |  |  | 四半期 / 半期 など |

## 4. データ分類と保護対象
| データ分類 | 代表例 | 保護レベル | 取扱ポリシー |
| --- | --- | --- | --- |
| PII | ユーザー氏名、住所 | 高 | 保存時暗号化 / アクセスログ必須 |
| 決済情報 | カード番号、トークン | 高 | PCI DSS 方針に準拠 |
| 内部メトリクス | 売上、KPI | 中 | IAM コントロール / マスキング |
|  |  |  |  |

## 5. 要件
### 5.1 認証・認可
| 優先度 | 要件 | 受入基準 | 検証タイミング |
| --- | --- | --- | --- |
| MUST | 全ての保護されたAPIは `Authorization: Bearer <JWT>` を要求する | 認証ヘッダ未提供で401を返す | 自動テスト / リリース前 |
| SHOULD | 管理系操作は `scope=admin` を必須にする | scope不足で403を返す | リリース前 |
| SHOULD | 管理者アカウントにMFAを必須化 | 設定済みアカウントはMFAプロンプトが出る | 半期レビュー |
|  |  |  |  |

### 5.2 通信の機密性
| 優先度 | 要件 | 受入基準 | 検証タイミング |
| --- | --- | --- | --- |
| MUST | 全トラフィックは TLS1.2 以上（HTTPS）で暗号化する。HTTPはリダイレクト不可 | SSL Labs 等でTLSバージョンが確認できる | リリース前 / 年次 |
| SHOULD | HSTS を有効化し、`max-age >= 31536000` を設定 | ブラウザセキュリティレポートで確認 | 半期レビュー |
|  |  |  |  |

### 5.3 データ保護（保存・転送）
| 優先度 | 要件 | 受入基準 | 検証タイミング |
| --- | --- | --- | --- |
| MUST | PIIは保存時に暗号化（例: DBカラムレベル AES-256） | 対象カラムが暗号化対象であることをDB設計で確認 | 設計レビュー |
| SHOULD | アクセストークン・シークレットはVault/SecretsManagerで管理 | リポジトリに平文のシークレットがない（secret-scanで検出なし） | CI / リリース前 |
|  |  |  |  |

### 5.4 ログと監査
| 優先度 | 要件 | 受入基準 | 検証タイミング |
| --- | --- | --- | --- |
| MUST | 監査ログは「誰が・いつ・何を」行ったかを保存する（保存期間: 90日以上） | 監査ログに user_id, action, timestamp が含まれている | 月次確認 |
| SHOULD | ログにPIIを平文で残さない（マスキング） | ログサンプルにプレーンPIIがない | 月次確認 |
|  |  |  |  |

### 5.5 インシデント対応
| 優先度 | 要件 | 受入基準 | 検証タイミング |
| --- | --- | --- | --- |
| MUST | 初動手順 (検知→エスカレーション→隔離→通知) を文書化し、連絡先を明記 | インシデントシミュレーション（年1回）の実施ログがある | 年次 |
| SHOULD | 重大度分類と報告 SLA を定義 | SLA 一覧が共有/合意済み | 半期レビュー |
|  |  |  |  |

### 5.6 脆弱性管理
| 優先度 | 要件 | 受入基準 | 検証タイミング |
| --- | --- | --- | --- |
| MUST | 依存ライブラリの自動脆弱性スキャンをCIに組み込む（例：Dependabot, Snyk） | 重大CVSS脆弱性は72時間以内にトリアージされるフローがある | 毎PR / 週次 |
| SHOULD | 年次ペネトレーションテストを実施し、対策を追跡する | レポートと改善チケットが管理されている | 年次 |
|  |  |  |  |

### 5.7 シークレット／鍵管理
| 優先度 | 要件 | 受入基準 | 検証タイミング |
| --- | --- | --- | --- |
| MUST | KMS/Vaultを用いた鍵管理、キーローテーション方針を定義 | キーのローテーション履歴が確認できる | 半期レビュー |
| SHOULD | 開発環境用シークレットと本番用シークレットを分離管理 | アクセス制御リストが分離されている | リリース前 |
|  |  |  |  |

## 6. 脅威モデリング / リスク評価
| 脅威シナリオ | 影響 | 対応策 | ステータス |
| --- | --- | --- | --- |
|  |  |  |  |

## 7. テスト／検証
| テスト種別 | 実施内容 | 実施タイミング | エビデンス |
| --- | --- | --- | --- |
| SAST | PR 時に解析しブロッカーは修正必須 | 毎PR | ツール名 / レポートURL |
| DAST | ステージングに対して自動実行 | 月次 | ツール名 / レポートURL |
| セキュリティレビュー | 新機能リリース前にセキュリティチェックリストを実施 | リリース前 | チェックリストへのリンク |
|  |  |  |  |

## 8. 運用・監視
- ログ保管場所:
- 保管期間:
- アクセス権限:
- 監視指標 / アラート閾値: (例: 認証失敗率 > 5% で PagerDuty)

## 9. コンプライアンス
- 適用規制 (例: 個人情報保護法, GDPR):
- 対応状況 / 証跡:
- 監査予定 / 直近監査結果:

## 10. 関連ドキュメント
- OpenAPI: `docs/specs/openapi.yaml`
- インシデント対応手順:
- セキュリティポリシー全体版:
- その他参照資料:

## 11. 変更履歴
- YYYY-MM-DD: 初版作成 (PR # / 担当者)
- YYYY-MM-DD:

